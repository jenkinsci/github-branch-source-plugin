<?jelly escape-by-default='true'?>
<j:jelly xmlns:j="jelly:core" xmlns:c="/lib/credentials"
         xmlns:f="/lib/form"
         xmlns:scm="/jenkins/scm/api/form">
  <f:entry title="${%Credentials}" field="credentialsId">
    <c:select checkMethod="post"/>
  </f:entry>

  <f:radioBlock name="configurableByScan" value="raw" checked="${!instance.isConfiguredByRepoScan()}" title="Github Repository HTTPs URL" inline="true">
    <f:nested>
      <f:entry title="HTTPS URL" field="rawUrl">
        <f:textbox/>
      </f:entry>
      <f:validateButton method="checkRepoURL" title="Validate" progress="Validating access..." with="rawUrl,credentialsId"/>
    </f:nested>
  </f:radioBlock>
  <f:radioBlock name="configurableByScan" value="scan" checked="${instance.isConfiguredByRepoScan()}" title="Github Repository Scan" inline="true">
    <f:nested>
      <j:choose>
        <j:when test="${descriptor.apiUriSelectable}">
          <f:entry title="${%API endpoint}" field="apiUri">
            <f:select/>
          </f:entry>
        </j:when>
        <j:otherwise>
          <f:invisibleEntry>
            <f:select field="apiUri"/>
          </f:invisibleEntry>
        </j:otherwise>
      </j:choose>

      <f:entry title ="${%Owner}" field="repoOwnerInternal">
        <f:textbox/>
      </f:entry>
      <f:entry title="${%Repository}" field="repositoryInternal">
        <f:select/>
      </f:entry>
      <f:validateButton method="checkRepoScan" title="Validate" progress="Validating access..." with="repoOwnerInternal,repositoryInternal,apiUri,credentialsId"/>
    </f:nested>
  </f:radioBlock>

  <script language="javascript" type="text/javascript" src="${rootURL}/plugin/github-branch-source/show.js"/>

  <f:entry title="${%Behaviours}">
    <scm:traits field="traits"/>
  </f:entry>

</j:jelly>
